---
import BaseLayout from '../layouts/BaseLayout.astro';

export async function getStaticPaths() {
	const response = await fetch('https://wiki.fgeierst.de/lib/exe/ajax.php?call=api&fn=pages');
	const pages = await response.json();
	const paramsList = pages.map(page => {
		const id = page.id.replace(':', '/');
		return {
			params: {
				id: id
			}
		}
	})
  return paramsList;
}
const {id} = Astro.request.params;

const response = await fetch(`https://wiki.fgeierst.de/lib/exe/ajax.php?call=api&fn=page&id=${id}`);
const page = await response.json();
---
<BaseLayout title={page.title} hasTitleElement={true}>
	<div set:html="page.html"></div>
</BaseLayout>